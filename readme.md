SKIER: A Symbolic Knowledge Integrated Model for Conversational Emotion Recognition
=========

## Overview
>In this repo, we put the data and code of the SKIER model for emotion recognition in conversations(ERC). 
>We propose a symbolic knowledge integrated model for the ERC task, named SKIER, which effectively leverages symbolic-based dependency knowledge at the utterance level, and commonsense knowledge at the concept level.
> We introduce a dialogue relation graph-based contextualizer for SKIER to functionally fuse utterance dependencies. Meanwhile, we propose
a relation-aware concept representation mechanism to integrate the concepts in different relations.
> Our method achieves state-of-the-art performance on the ERC task.



<img src="https://github.com/Maxwe11y/JointEC/blob/main/model_p2_v2-1.png" width = 55% height = 55% div align=center />

<!-- <figure class="half">
  <img src="https://github.com/Maxwe11y/JointEC/blob/main/model_step_1_10-1.png" width = 45% height = 45% div align=left />
  <img src="https://github.com/Maxwe11y/JointEC/blob/main/model_p2_v2-1.png" width = 45% height = 45% div align=right />
</figure> -->

### Dataset Structure

The structure of the data dir is as follows:

```
data
â””â”€â”€â”€   EMORY
       â””â”€â”€â”€ EMORY.pkl
       â””â”€â”€â”€ EMORY_revised.pkl
â””â”€â”€â”€   dailydialog
       â””â”€â”€â”€ Daily.zip
       â””â”€â”€â”€ Daily_revised.zip
       â””â”€â”€â”€ daily_.json
â””â”€â”€â”€   dialog_concept
       â””â”€â”€â”€ causes_weight_dict_all.json
       â””â”€â”€â”€ hascontext_weight_dict_all.json
       â””â”€â”€â”€ isa_dict_all.json
       â””â”€â”€â”€ isa_weight_dict_all.json
```
 MELD(Plz check out the following sharing link)
 * [MELD_revised](https://www.dropbox.com/s/edspgpbgnouh21h/MELD_revised.zip?dl=0)
 * [MELD](https://www.dropbox.com/s/5m6rcg5g2nhys22/MELD.zip?dl=0)



## Uasge
In order to implement the proposed SKIER framework, you have to download the pre-trained GloVe vectors(glove.6B.100d.txt is the most commonly used vectors in this project).
The downloaded GloVe vectors should be placed in glove dir(plz create glove dir if empty). Note that the batch size should be set to 1 as we process one dialogue each time.

ðŸ‘‰ Check out [GloVe Embeddings](https://nlp.stanford.edu/data/glove.6B.zip) before you run the **code**.


To run this code, plz use the following command (take dailydialogue as an example)
```
python3 train_dd.py --model-type roberta_large --att_dropout 0.5 --output_dim 1024 --chunk_size 50 --base-lr 0.0000005  --epochs 15 --num_epochs 40 --num_relations 11 --data_type daily --num_features 3 --freeze_glove --num_class 7 --use_fixed
```

the proposed step 1 models (specified in ["ECPEC: Emotion-Cause Pair Extraction in Conversations"]) and Joint-EC is the step 2 model.
* Dataset folder contains the new ConvECPE dataset.
* Joint-Xatt folder is the implementation of Joint-Xatt model. You can directly run the Joint_Xatt_l3.py file.
* Joint-GCN folder is the implementation of Joint-GCN model. You can directly run the Joint_GCN4.py file.
* Joint-EC folder is the implementation of Joint-EC/Joint-ECW model. You need to first gather the predicted results generated by the step 1 model and then run the JointEC.py/JointEC_window file. Note that convert_window_to_normal.py is used to convert the result of Joint-ECW to normal result considering window restriction.

Below is the structure of the whole project:
```
JointEC Project
â”‚   README.md
â”‚   requirements_jointEC.txt
|   model_p2_v2-1.png
â”‚   .gitignore
â”‚
â””â”€â”€â”€Dataset
â”‚   â”‚   IEMOCAP_emotion_cause_features.pkl
â”‚   
â””â”€â”€â”€Joint-EC
â”‚   â”‚   JointEC.py
â”‚   â”‚   JointEC_window.py
â”‚   â”‚   convert_window_to_normal.py
â”‚   â”‚   dataloader_jointEC_window.py
â”‚   â”‚   dataloader_jointEC_window.py
â”‚   â”‚   key_words.txt
â”‚   â”‚   prepare_data.py
â”‚
â””â”€â”€â”€Joint-GCN
â”‚   â”‚   GCN_features.py
â”‚   â”‚   JointGCN4.py
â”‚   â”‚   dataloader_gcn.py
â”‚   â”‚   key_words.txt
â”‚   â”‚   prepare_data.py
â”‚
â””â”€â”€â”€Joint-Xatt
    â”‚   Joint_Xatt_l3.py
    â”‚   dataloader.py
    â”‚   key_words.txt
    â”‚   prepare_data.py
```

###
Detailed description of this project will come soon...

